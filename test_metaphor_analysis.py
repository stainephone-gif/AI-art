"""
Test script for demonstrating enhanced metaphor analysis
"""

from metaphor_analyzer import (
    MetaphorAnalyzer,
    MetaphorLevel,
    MetaphorType
)
import json


def print_separator(title=""):
    """Print separator line"""
    if title:
        print("\n" + "=" * 70)
        print(f"  {title}")
        print("=" * 70)
    else:
        print("-" * 70)


def analyze_text(analyzer, text, title):
    """Analyze text and print results"""
    print_separator(title)
    print("\n–¢–ï–ö–°–¢:")
    print(text.strip())
    print()

    # Extract metaphors
    evidence = analyzer.extract_metaphors(text)

    if not evidence:
        print("‚ùå –ú–µ—Ç–∞—Ñ–æ—Ä—ã –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω—ã")
        return

    print(f"‚úÖ –û–±–Ω–∞—Ä—É–∂–µ–Ω–æ –º–µ—Ç–∞—Ñ–æ—Ä: {len(evidence)}\n")

    # Print each evidence
    for i, e in enumerate(evidence, 1):
        print(f"–ú–µ—Ç–∞—Ñ–æ—Ä–∞ #{i}:")
        print(f"  –¢–µ–æ—Ä–∏—è: {e.theory_class}")
        print(f"  –£—Ä–æ–≤–µ–Ω—å: {e.level.value}")
        print(f"  –¢–∏–ø: {e.type.value}")
        print(f"  –í–µ—Å: {e.weight:.3f}")
        print(f"  –°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–µ –ø–æ–ª–µ: {e.semantic_field}")
        print(f"  –¢–µ–∫—Å—Ç: '{e.span}'")
        print(f"  –û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ: {e.reasoning}")
        print()

    # Analyze network
    network = analyzer.analyze_metaphor_network(evidence)

    print_separator("–ê–Ω–∞–ª–∏–∑ —Å–µ—Ç–∏ –º–µ—Ç–∞—Ñ–æ—Ä")
    print(f"\nüéØ –î–æ–º–∏–Ω–∏—Ä—É—é—â–∞—è —Ç–µ–æ—Ä–∏—è: {network.get('dominant_pattern', 'N/A')}")
    print(f"üé® Meta-metaphor –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∞: {network.get('meta_metaphor_detected', False)}")

    if network.get('hybrid_theories'):
        print(f"‚ö†Ô∏è  –ì–∏–±—Ä–∏–¥–Ω—ã–µ —Ç–µ–æ—Ä–∏–∏: {', '.join(network['hybrid_theories'])}")

    print("\n–ö–ª–∞—Å—Ç–µ—Ä—ã –ø–æ —Ç–µ–æ—Ä–∏—è–º:")
    for theory, cluster in network.get('clusters', {}).items():
        print(f"\n  {theory}:")
        print(f"    –í—Å–µ–≥–æ —Å–≤–∏–¥–µ—Ç–µ–ª—å—Å—Ç–≤: {cluster['total_evidence']}")
        print(f"    Meta-metaphors: {cluster['meta_metaphor_count']}")
        print(f"    Scientific metaphors: {cluster['scientific_metaphor_count']}")
        print(f"    Ontological: {cluster['ontological_count']}")
        print(f"    –û–±—â–∏–π –≤–µ—Å: {cluster['total_weight']:.2f}")


def main():
    """Run tests"""
    print_separator("üß™ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï –°–ò–°–¢–ï–ú–´ –ê–ù–ê–õ–ò–ó–ê –ú–ï–¢–ê–§–û–†")

    analyzer = MetaphorAnalyzer()

    # Test 1: Pure PRED with meta-metaphor
    test1 = """
    –†–∞–±–æ—Ç–∞ –∏—Å—Å–ª–µ–¥—É–µ—Ç –∫–∞–∫ –≥–µ–Ω–µ—Ä–∞—Ç–∏–≤–Ω–∞—è –º–æ–¥–µ–ª—å —Å–æ–∑–¥–∞—ë—Ç –æ–±—Ä–∞–∑—ã,
    –¥–µ–π—Å—Ç–≤—É—è –ø–æ–¥–æ–±–Ω–æ –≤–æ–æ–±—Ä–∞–∂–µ–Ω–∏—é. –ù–µ–π—Ä–æ—Å–µ—Ç—å –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–µ—Ç –∏
    —Å–∏–Ω—Ç–µ–∑–∏—Ä—É–µ—Ç –Ω–æ–≤–æ–µ –≤–æ—Å–ø—Ä–∏—è—Ç–∏–µ, –º–∏–Ω–∏–º–∏–∑–∏—Ä—É—è –æ—à–∏–±–∫—É –º–µ–∂–¥—É
    –ø—Ä–æ–≥–Ω–æ–∑–æ–º –∏ —Ä–µ–∞–ª—å–Ω–æ—Å—Ç—å—é. –≠—Ç–æ —Ö—É–¥–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ
    –ø—Ä–µ–¥–∏–∫—Ç–∏–≤–Ω–æ–≥–æ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è –∫–∞–∫ –æ—Å–Ω–æ–≤—ã —Ç–≤–æ—Ä—á–µ—Å—Ç–≤–∞.
    """
    analyze_text(analyzer, test1, "–¢–ï–°–¢ 1: PRED —Å meta-metaphor")

    # Test 2: COMP + ENACT hybrid
    test2 = """
    –ê–ª–≥–æ—Ä–∏—Ç–º –ø—Ä–µ–≤—Ä–∞—â–∞–µ—Ç—Å—è –≤ —Ç–µ–ª–µ—Å–Ω–æ–≥–æ –∞–≥–µ–Ω—Ç–∞, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–Ω–∞—ë—Ç
    –º–∏—Ä —á–µ—Ä–µ–∑ —Å–µ–Ω—Å–æ–º–æ—Ç–æ—Ä–Ω–æ–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ. –ö–æ–¥ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è
    –≤–æ–ø–ª–æ—â—ë–Ω–Ω—ã–º —Ä–∞–∑—É–º–æ–º, –¥–µ–π—Å—Ç–≤—É—é—â–∏–º –≤ –º–∞—Ç–µ—Ä–∏–∞–ª—å–Ω–æ–π —Å—Ä–µ–¥–µ.
    –í—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å –æ–±—Ä–µ—Ç–∞–µ—Ç —Ç–µ–ª–µ—Å–Ω–æ—Å—Ç—å.
    """
    analyze_text(analyzer, test2, "–¢–ï–°–¢ 2: –ì–∏–±—Ä–∏–¥ COMP + ENACT")

    # Test 3: EMERG with collective intelligence
    test3 = """
    –ú–Ω–æ–∂–µ—Å—Ç–≤–æ –ø—Ä–æ—Å—Ç—ã—Ö –∞–≥–µ–Ω—Ç–æ–≤ —Å–∞–º–æ–æ—Ä–≥–∞–Ω–∏–∑—É–µ—Ç—Å—è –≤ –∫–æ–ª–ª–µ–∫—Ç–∏–≤–Ω—ã–π
    —Ä–∞–∑—É–º. –ò–∑ —Ö–∞–æ—Å–∞ –≤–æ–∑–Ω–∏–∫–∞–µ—Ç —Å–ø–æ–Ω—Ç–∞–Ω–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫, –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É—è
    —ç–º–µ—Ä–¥–∂–µ–Ω—Ç–Ω–æ—Å—Ç—å —Å–æ–∑–Ω–∞–Ω–∏—è. –†–æ–µ–≤–æ–π –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç —Ç–≤–æ—Ä–∏—Ç –∫–∞–∫ –µ–¥–∏–Ω–æ–µ
    —Ü–µ–ª–æ–µ, –ø—Ä–µ–≤–æ—Å—Ö–æ–¥—è—â–µ–µ —Å—É–º–º—É —á–∞—Å—Ç–µ–π.
    """
    analyze_text(analyzer, test3, "–¢–ï–°–¢ 3: EMERG —Ä–æ–µ–≤–æ–π –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç")

    # Test 4: IIT integration
    test4 = """
    –†–∞–±–æ—Ç–∞ –∏—Å—Å–ª–µ–¥—É–µ—Ç –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –∫–∞–∫ –æ—Å–Ω–æ–≤—É
    —Å—É–±—ä–µ–∫—Ç–∏–≤–Ω–æ–≥–æ –æ–ø—ã—Ç–∞. –û–±—Ä–∞–∑ –Ω–µ–¥–µ–ª–∏–º, –µ–≥–æ –Ω–µ–ª—å–∑—è —Ä–∞–∑–ª–æ–∂–∏—Ç—å
    –Ω–∞ —á–∞—Å—Ç–∏ –±–µ–∑ –ø–æ—Ç–µ—Ä–∏ —Å—É—â–Ω–æ—Å—Ç–∏. –ö–≤–∞–ª–∏–∞ –≤–æ–∑–Ω–∏–∫–∞–µ—Ç –∏–∑
    –Ω–µ—Å–≤–æ–¥–∏–º–æ–π —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ –≤–æ—Å–ø—Ä–∏—è—Ç–∏—è.
    """
    analyze_text(analyzer, test4, "–¢–ï–°–¢ 4: IIT –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è")

    # Test 5: Decorative (should be low weight)
    test5 = """
    –ö—Ä–∞—Å–∏–≤–∞—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö —Å–æ–∑–¥–∞—ë—Ç —ç—Å—Ç–µ—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏—è—Ç–Ω—ã–µ
    –ø–∞—Ç—Ç–µ—Ä–Ω—ã –Ω–∞ —ç–∫—Ä–∞–Ω–µ, —Ä–∞–¥—É—è –≥–ª–∞–∑ –∑—Ä–∏—Ç–µ–ª—è —è—Ä–∫–∏–º–∏ —Ü–≤–µ—Ç–∞–º–∏.
    """
    analyze_text(analyzer, test5, "–¢–ï–°–¢ 5: –î–µ–∫–æ—Ä–∞—Ç–∏–≤–Ω—ã–π (UND)")

    # Test 6: GWT attention mechanism
    test6 = """
    –°–∏—Å—Ç–µ–º–∞ –≤–Ω–∏–º–∞–Ω–∏—è –¥–µ–π—Å—Ç–≤—É–µ—Ç –∫–∞–∫ –ø—Ä–æ–∂–µ–∫—Ç–æ—Ä —Å–æ–∑–Ω–∞–Ω–∏—è,
    –æ—Å–≤–µ—â–∞—è –∏–∑–±—Ä–∞–Ω–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã –Ω–∞ —Å—Ü–µ–Ω–µ –≤–æ—Å–ø—Ä–∏—è—Ç–∏—è.
    –ì–ª–æ–±–∞–ª—å–Ω–æ–µ —Ä–∞–±–æ—á–µ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ —Ç—Ä–∞–Ω—Å–ª–∏—Ä—É–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é,
    –¥–µ–ª–∞—è –µ—ë –¥–æ—Å—Ç—É–ø–Ω–æ–π –¥–ª—è –æ—Å–æ–∑–Ω–∞–Ω–∏—è.
    """
    analyze_text(analyzer, test6, "–¢–ï–°–¢ 6: GWT –≤–Ω–∏–º–∞–Ω–∏–µ")

    # Test 7: PAN animism
    test7 = """
    –ú–∞—Ç–µ—Ä–∏–∞–ª –æ–±—Ä–µ—Ç–∞–µ—Ç –≤–Ω—É—Ç—Ä–µ–Ω–Ω—é—é –∂–∏–∑–Ω—å, –∫–∞–∂–¥—ã–π –ø–∏–∫—Å–µ–ª—å
    —á—É–≤—Å—Ç–≤—É–µ—Ç –∏ —Ä–µ–∞–≥–∏—Ä—É–µ—Ç. –û–±—ä–µ–∫—Ç—ã –æ–¥—É—à–µ–≤–ª—è—é—Ç—Å—è, –ø—Ä–æ—è–≤–ª—è—è
    –ø—Ä–æ—Ç–æ–æ–ø—ã—Ç. –≠—Ç–æ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –ø–∞–Ω–ø—Å–∏—Ö–∏–∑–º–∞ —á–µ—Ä–µ–∑ –∂–∏–≤—É—é
    –º–∞—Ç–µ—Ä–∏—é —Ü–∏—Ñ—Ä–æ–≤–æ–≥–æ –∏—Å–∫—É—Å—Å—Ç–≤–∞.
    """
    analyze_text(analyzer, test7, "–¢–ï–°–¢ 7: PAN –æ–¥—É—à–µ–≤–ª–µ–Ω–∏–µ")

    # Test 8: Complex meta-metaphor
    test8 = """
    –ì–µ–Ω–µ—Ä–∞—Ç–∏–≤–Ω–æ-—Å–æ—Å—Ç—è–∑–∞—Ç–µ–ª—å–Ω–∞—è —Å–µ—Ç—å –ø—Ä–µ–≤—Ä–∞—â–∞–µ—Ç –∞–ª–≥–æ—Ä–∏—Ç–º –≤
    —Ö—É–¥–æ–∂–Ω–∏–∫–∞, –∫–æ—Ç–æ—Ä—ã–π –≤–æ–æ–±—Ä–∞–∂–∞–µ—Ç –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –æ–±—Ä–∞–∑—ã.
    –ü—Ä–æ—Ü–µ—Å—Å –º–∏–Ω–∏–º–∏–∑–∞—Ü–∏–∏ —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏—è –º–µ–∂–¥—É –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–æ–º –∏
    –¥–∏—Å–∫—Ä–∏–º–∏–Ω–∞—Ç–æ—Ä–æ–º —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –º–µ—Ç–∞—Ñ–æ—Ä–æ–π —Ç–≤–æ—Ä—á–µ—Å–∫–æ–≥–æ –¥–∏–∞–ª–æ–≥–∞.
    –ü—Ä–µ–¥–∏–∫—Ç–∏–≤–Ω–æ–µ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–±—Ä–µ—Ç–∞–µ—Ç —Ö—É–¥–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—É—é —Ñ–æ—Ä–º—É.
    """
    analyze_text(analyzer, test8, "–¢–ï–°–¢ 8: –°–ª–æ–∂–Ω–∞—è meta-metaphor (PRED+COMP)")

    print_separator("‚úÖ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï –ó–ê–í–ï–†–®–ï–ù–û")


if __name__ == "__main__":
    main()
